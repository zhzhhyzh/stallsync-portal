export const accessType = {

  ANNOUNCE_VIEW: {
    type: "ANNOUNCE",
    function: "ANNOUNCE",
    action: "VIEW",
  },
  ANNOUNCE_ADD: {
    type: "ANNOUNCE",
    function: "ANNOUNCE",
    action: "ADD",
  },
  ANNOUNCE_EDIT: {
    type: "ANNOUNCE",
    function: "ANNOUNCE",
    action: "EDIT",
  },
  ANNOUNCE_DEL: {
    type: "ANNOUNCE",
    function: "ANNOUNCE",
    action: "DEL",
  },

  FILEMANAGE_VIEW: {
    type: "SET",
    function: "FILEMANAGE",
    action: "VIEW",
  },
  FILEMANAGE_DEL: {
    type: "SET",
    function: "FILEMANAGE",
    action: "DEL",
  },

  FILEMANAGE_ADD: {
    type: "SET",
    function: "FILEMANAGE",
    action: "ADD",
  },

  FILEMANAGE_EDIT: {
    type: "SET",
    function: "FILEMANAGE",
    action: "EDIT",
  },

  TABLEKEY_VIEW: {
    type: "SET",
    function: "TABLEKEY",
    action: "VIEW",
  },

  TABLEKEY_DEL: {
    type: "SET",
    function: "TABLEKEY",
    action: "DEL",
  },

  TABLEKEY_ADD: {
    type: "SET",
    function: "TABLEKEY",
    action: "ADD",
  },

  TABLEKEY_EDIT: {
    type: "SET",
    function: "TABLEKEY",
    action: "EDIT",
  },
  FUNC_VIEW: {
    type: "PARAM",
    function: "FUNC",
    action: "VIEW",
  },
  FUNC_ADD: {
    type: "PARAM",
    function: "FUNC",
    action: "ADD",
  },
  FUNC_EDIT: {
    type: "PARAM",
    function: "FUNC",
    action: "EDIT",
  },
  FUNC_DEL: {
    type: "PARAM",
    function: "FUNC",
    action: "DEL",
  },

  GEN_VIEW: {
    type: "PARAM",
    function: "GEN",
    action: "VIEW",
  },
  GEN_ADD: {
    type: "PARAM",
    function: "GEN",
    action: "ADD",
  },
  GEN_EDIT: {
    type: "PARAM",
    function: "GEN",
    action: "EDIT",
  },
  GEN_DEL: {
    type: "PARAM",
    function: "GEN",
    action: "DEL",
  },
  ADMA_VIEW: {
    type: "SET",
    function: "ADMA",
    action: "VIEW",
  },
  ADMA_ADD: {
    type: "SET",
    function: "ADMA",
    action: "ADD",
  },
  ADMA_EDIT: {
    type: "SET",
    function: "ADMA",
    action: "EDIT",
  },
  ADMA_DEL: {
    type: "SET",
    function: "ADMA",
    action: "DEL",
  }
  ,


  TRANCODE_VIEW: {
    type: "PARAM",
    function: "TRANCODE",
    action: "VIEW",
  },
  TRANCODE_ADD: {
    type: "PARAM",
    function: "TRANCODE",
    action: "ADD",
  },
  TRANCODE_EDIT: {
    type: "PARAM",
    function: "TRANCODE",
    action: "EDIT",
  },
  TRANCODE_DEL: {
    type: "PARAM",
    function: "TRANCODE",
    action: "DEL",
  },



  PROF_VIEW: {
    type: "SET",
    function: "PROF",
    action: "VIEW",
  },
  PROF_EDIT: {
    type: "SET",
    function: "PROF",
    action: "EDIT",
  },

  PWPOLICY_VIEW: {
    type: "PARAM",
    function: "PWPOLICY",
    action: "VIEW",
  },
  PWPOLICY_EDIT: {
    type: "PARAM",
    function: "PWPOLICY",
    action: "EDIT",
  },
  BACKUP_VIEW: {
    type: "CONFIG",
    function: "BACKUP",
    action: "VIEW",
  },
  BACKUP_ADD: {
    type: "CONFIG",
    function: "BACKUP",
    action: "ADD",
  },
  BACKUP_DOWNLOAD: {
    type: "CONFIG",
    function: "BACKUP",
    action: "DOWNLOAD",
  },


  ROLE_VIEW: {
    type: "PARAM",
    function: "ROLE",
    action: "VIEW",
  },
  ROLE_ADD: {
    type: "PARAM",
    function: "ROLE",
    action: "ADD",
  },
  ROLE_EDIT: {
    type: "PARAM",
    function: "ROLE",
    action: "EDIT",
  },
  ROLE_DELETE: {
    type: "PARAM",
    function: "ROLE",
    action: "DEL",
  },





  // ----------Seperator----------- ::;
  ACES_VIEW: {
    type: "PARAM",
    function: "ACES",
    action: "VIEW",
  },
  ACES_EDIT: {
    type: "PARAM",
    function: "ACES",
    action: "EDIT",
  },

  STAFF_VIEW: {
    type: "STAFF",
    function: "STAFF",
    action: "VIEW",
  },
  STAFF_ADD: {
    type: "STAFF",
    function: "STAFF",
    action: "ADD",
  },
  STAFF_EDIT: {
    type: "STAFF",
    function: "STAFF",
    action: "EDIT",
  },
  STAFF_DEL: {
    type: "STAFF",
    function: "STAFF",
    action: "DEL",
  },

  MCH_VIEW: {
    type: "PARAM",
    function: "MCH",
    action: "VIEW",
  },
  MCH_ADD: {
    type: "PARAM",
    function: "MCH",
    action: "ADD",
  },
  MCH_EDIT: {
    type: "PARAM",
    function: "MCH",
    action: "EDIT",
  },
  MCH_DEL: {
    type: "PARAM",
    function: "MCH",
    action: "DEL",
  },
  RWD_VIEW: {
    type: "PARAM",
    function: "RWD",
    action: "VIEW",
  },
  RWD_ADD: {
    type: "PARAM",
    function: "RWD",
    action: "ADD",
  },
  RWD_EDIT: {
    type: "PARAM",
    function: "RWD",
    action: "EDIT",
  },
  RWD_DEL: {
    type: "PARAM",
    function: "RWD",
    action: "DEL",
  },
  PROD_VIEW: {
    type: "PARAM",
    function: "PROD",
    action: "VIEW",
  },
  PROD_ADD: {
    type: "PARAM",
    function: "PROD",
    action: "ADD",
  },
  PROD_EDIT: {
    type: "PARAM",
    function: "PROD",
    action: "EDIT",
  },
  PROD_DEL: {
    type: "PARAM",
    function: "PROD",
    action: "DEL",
  },
   ORD_VIEW: {
    type: "ORD",
    function: "ORD",
    action: "VIEW",
  },
  ORD_ADD: {
    type: "ORD",
    function: "ORD",
    action: "ADD",
  },
  ORD_EDIT: {
    type: "ORD",
    function: "ORD",
    action: "EDIT",
  },
  ORD_DEL: {
    type: "ORD",
    function: "ORD",
    action: "DEL",
  },

  INV_VIEW: {
    type: "PARAM",
    function: "INV",
    action: "VIEW",
  },
  INV_ADD: {
    type: "PARAM",
    function: "INV",
    action: "ADD",
  },
  INV_EDIT: {
    type: "PARAM",
    function: "INV",
    action: "EDIT",
  },
  MBR_VIEW: {
    type: "MBR",
    function: "MBR",
    action: "VIEW",
  },

  MBR_EDIT: {
    type: "MBR",
    function: "MBR",
    action: "EDIT",
  },

};

const accessPath = {
  "/functions": accessType.FUNC_VIEW,
  "/functions/Detail": [
    accessType.FUNC_ADD,
    accessType.FUNC_EDIT,
    accessType.FUNC_DEL,
  ],



  "/generalParameter": accessType.GEN_VIEW,
  "/generalParameter/Detail": [
    accessType.GEN_ADD,
    accessType.GEN_EDIT,
    accessType.GEN_DEL
  ],
  "/generalParameter/generalCode": accessType.GEN_VIEW,
  "/generalParameter/generalCode/Detail": [
    accessType.GEN_ADD,
    accessType.GEN_EDIT,
    accessType.GEN_DEL
  ],

  "/adminAccounts": accessType.ADMA_VIEW,
  "/adminAccounts/Detail": [
    accessType.ADMA_ADD,
    accessType.ADMA_EDIT,
    accessType.ADMA_DEL
  ],


  "/roleCode": accessType.ROLE_VIEW,
  "/roleCode/Detail": [
    accessType.ROLE_ADD,
    accessType.ROLE_EDIT,
    accessType.ROLE_DELETE
  ],

  "/tranCode": accessType.TRANCODE_VIEW,
  "/tranCode/Detail": [
    accessType.TRANCODE_ADD,
    accessType.TRANCODE_EDIT,
    accessType.TRANCODE_DEL,
  ],

  "/profile/changePassword": accessType.PROF_EDIT,
  "/profile/myProfile": accessType.PROF_EDIT,

  "/passwordPolicy": [accessType.PWPOLICY_VIEW, accessType.PWPOLICY_EDIT],

  "/backup": accessType.BACKUP_VIEW,




  "/announcement": accessType.ANNOUNCE_VIEW,
  "/announcement/Detail": [
    accessType.ANNOUNCE_ADD,
    accessType.ANNOUNCE_EDIT,
    accessType.ANNOUNCE_DEL,
  ],

  "/accessibility": accessType.ACES_VIEW,
  "/staff": accessType.STAFF_VIEW,
  "/staff/Detail": [
    accessType.STAFF_ADD,
    accessType.STAFF_EDIT,
    accessType.STAFF_DEL,
  ],
  "/merchant": accessType.MCH_VIEW,
  "/merchant/Detail": [
    accessType.MCH_ADD,
    accessType.MCH_EDIT,
    accessType.MCH_DEL,
  ],
  "/reward": accessType.RWD_VIEW,
  "/reward/Detail": [
    accessType.RWD_ADD,
    accessType.RWD_EDIT,
    accessType.RWD_DEL,
  ],
  "/product": accessType.PROD_VIEW,
  "/product/Detail": [
    accessType.PROD_ADD,
    accessType.PROD_EDIT,
    accessType.PROD_DEL,
  ],

  "/order": accessType.ORD_VIEW,
  "/order/Detail": [
    // accessType.ORD_ADD,
    accessType.ORD_EDIT,
    // accessType.ORD_DEL,
  ],

  "/mbrProfile": accessType.MBR_VIEW,
  "/mbrProfile/Detail": [
    accessType.MBR_EDIT,
  ],

  "/product/inventory": accessType.INV_VIEW,
  "/product/inventory/Detail": [
    accessType.INV_ADD,
    accessType.INV_EDIT,
  ],
};

export function checkAccessMatrixRedirect(router, accessMatrix) {
  let redirect = false;
  if (accessPath[router.pathname]) {
    let paths = [];
    if (Array.isArray(accessPath[router.pathname])) {
      paths = accessPath[router.pathname];
    } else {
      paths = [accessPath[router.pathname]];
    }

    for (const path of paths) {
      if (
        !path ||
        !accessMatrix[path.type] ||
        (accessMatrix[path.type] && accessMatrix[path.type].length === 0)
      ) {
        redirect = true;
      } else {
        const functionAccess = accessMatrix[path.type].find(
          (item) => item.prfuncde === path.function
        );

        if (functionAccess === undefined) {
          redirect = true;
        } else if (functionAccess?.prfunacs === 0) {
          redirect = true;
        } else {
          const actionAccess = functionAccess?.actions.find(
            (item) => item.key === path.action
          );
          if (actionAccess?.checked === 0) {
            redirect = true;
          }
        }
      }
    }
  }
  if (redirect) {
    router.replace("/");
  }
}

export function checkAccessMatrix(accessMatrix, path) {
  let canAccess = true;
  const functionAccess = accessMatrix[path.type].find(
    (item) => item.prfuncde === path.function
  );

  if (functionAccess?.prfunacs === 0) {
    canAccess = false;
  } else {
    const actionAccess = functionAccess?.actions.find(
      (item) => item.key === path.action
    );
    if (actionAccess?.checked === 0) {
      canAccess = false;
    }
  }
  return canAccess;
}

export function checkMenuAccessMatrix(accessMatrix, paths) {
  if (!paths) return true;

  let canAccess = false;
  for (const path of paths) {
    const functionAccess = accessMatrix[path.type] ? accessMatrix[path.type].find(
      (item) => item.prfuncde === path.function
    ) : {};

    if (functionAccess?.prfunacs === 1) {
      const actionAccess = functionAccess?.actions.find(
        (item) => item.key === path.action
      );
      if (actionAccess?.checked === 1) {
        canAccess = true;
      }
    }
  }
  return canAccess;
}
